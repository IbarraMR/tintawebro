{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"/>
    <meta http-equiv="Pragma" content="no-cache"/>
    <meta http-equiv="Expires" content="0"/>

    <title>Tinta Negra | {% block title %}{% endblock %}</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="stylesheet" href="{% static 'core/css/styles.css' %}">
</head>
<body>

{% if user.is_authenticated %}
<header class="main-header bg-dark text-white py-2 px-3 d-flex align-items-center">
    <a class="navbar-brand" href="{% url 'home' %}">
        <img src="{% static 'core/logoTintaBlanco.png' %}" alt="TINTA NEGRA" style="height: 50px;">
    </a>
</header>
{% endif %}

<div class="main-layout d-flex">

{% if user.is_authenticated %}
<nav class="sidebar d-flex flex-column justify-content-between p-3"
     style="min-height: 100vh; width: 240px; background-color: #1c1c1c;">

    <div>
        <div class="sidebar-user text-white mb-3">
            <strong>Hola {{ request.user.username|title }}!</strong>
        </div>

        <ul class="nav flex-column">

            <!-- DASHBOARD -->
            <li class="nav-item mb-1">
                <a class="nav-link text-white {% if request.resolver_match.url_name == 'home' %}active{% endif %}"
                   href="{% url 'home' %}">
                    <i class="fas fa-tachometer-alt me-2"></i> Dashboard
                </a>
            </li>

            <!-- CLIENTES -->
            {% if perms.core.view_cliente %}
            <li class="nav-item mb-1">
                <a class="nav-link text-white {% if request.resolver_match.url_name == 'clientes_list' %}active{% endif %}"
                   href="{% url 'clientes_list' %}">
                    <i class="fas fa-users me-2"></i> Clientes
                </a>
            </li>
            {% endif %}

            <!-- PEDIDOS -->
            {% if perms.core.view_pedidos %}
            <li class="nav-item mb-1">
                <a class="nav-link text-white {% if request.resolver_match.url_name == 'pedidos_list' %}active{% endif %}"
                   href="{% url 'pedidos_list' %}">
                    <i class="fas fa-clipboard-list me-2"></i> Pedidos
                </a>
            </li>
            {% endif %}

            <!-- PRESUPUESTOS -->
            {% if perms.core.view_presupuestos %}
            <li class="nav-item mb-1">
                <a class="nav-link text-white {% if request.resolver_match.url_name == 'presupuestos_list' %}active{% endif %}"
                   href="{% url 'presupuestos_list' %}">
                    <i class="fas fa-file-invoice-dollar me-2"></i> Presupuestos
                </a>
            </li>
            {% endif %}

            <!-- COMPRAS -->
            {% if perms.core.view_compras %}
            <li class="nav-item mb-1">
                <a class="nav-link text-white {% if request.resolver_match.url_name == 'compras_list' %}active{% endif %}"
                   href="{% url 'compras_list' %}">
                    <i class="fa-solid fa-cart-shopping me-2"></i> Compras
                </a>
            </li>
            {% endif %}

            <!-- INSUMOS -->
            {% if perms.core.view_insumos %}
            <li class="nav-item mb-1">
                <a class="nav-link text-white {% if request.resolver_match.url_name == 'insumos_list' %}active{% endif %}"
                   href="{% url 'insumos_list' %}">
                    <i class="fas fa-box me-2"></i> Stock de insumos
                </a>
            </li>
            {% endif %}

            <!-- CAJA -->
            {% if perms.core.view_cajas %}
            <li class="nav-item mb-1">
                <a class="nav-link d-flex align-items-center text-white"
                   data-bs-toggle="collapse"
                   href="#submenuCaja"
                   role="button"
                   aria-expanded="{% if request.path|slice:'0:6' == '/cajas' %}true{% else %}false{% endif %}"
                   aria-controls="submenuCaja">
                    <i class="fas fa-cash-register me-2"></i> Caja
                </a>
            </li>

            <div class="collapse {% if request.path|slice:'0:6' == '/cajas' %}show{% endif %}" id="submenuCaja">
                <ul class="nav flex-column ms-4">

                    <li class="nav-item mb-1">
                        <a class="nav-link text-white {% if request.resolver_match.url_name == 'cajas_list' %}active{% endif %}"
                           href="{% url 'cajas_list' %}">
                            Panel de Caja
                        </a>
                    </li>

                    <li class="nav-item mb-1">
                        <a class="nav-link text-white {% if request.resolver_match.url_name == 'movimientos_list' %}active{% endif %}"
                           href="{% url 'movimientos_list' %}">
                            Movimientos de Caja
                        </a>
                    </li>

                    <li class="nav-item mb-1">
                        <a class="nav-link text-white {% if request.resolver_match.url_name == 'formas_pago_list' %}active{% endif %}"
                           href="{% url 'formas_pago_list' %}">
                            Formas de Pago
                        </a>
                    </li>

                </ul>
            </div>
            {% endif %}

            <!-- PROVEEDORES -->
            {% if perms.core.view_proveedores %}
            <li class="nav-item mb-1">
                <a class="nav-link text-white {% if request.resolver_match.url_name == 'proveedores_list' %}active{% endif %}"
                   href="{% url 'proveedores_list' %}">
                    <i class="fas fa-truck-moving me-2"></i> Proveedores
                </a>
            </li>
            {% endif %}

            <!-- EMPLEADOS -->
            {% if perms.core.view_empleados %}
            <li class="nav-item mb-1">
                <a class="nav-link text-white {% if request.resolver_match.url_name == 'empleados_list' %}active{% endif %}"
                   href="{% url 'empleados_list' %}">
                    <i class="fas fa-user-tie me-2"></i> Empleados
                </a>
            </li>
            {% endif %}

            <!-- CONFIGURACION -->
            {% if perms.auth.change_group %}
            <li class="nav-item mb-1">
                <a class="nav-link text-white {% if request.resolver_match.url_name == 'configuracion' %}active{% endif %}"
                   href="{% url 'configuracion' %}">
                    <i class="fas fa-cogs me-2"></i> Configuración
                </a>
            </li>
            {% endif %}
        </ul>
    </div>

    <div class="mt-3">
        <form action="{% url 'logout' %}" method="post">
            {% csrf_token %}
            <button type="submit" class="btn btn-danger w-100 btn-sm">
                <i class="fas fa-sign-out-alt me-2"></i> Cerrar sesión
            </button>
        </form>
    </div>

</nav>
{% endif %}

<main class="main-content flex-grow-1">
    {% block content %}{% endblock %}
</main>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
